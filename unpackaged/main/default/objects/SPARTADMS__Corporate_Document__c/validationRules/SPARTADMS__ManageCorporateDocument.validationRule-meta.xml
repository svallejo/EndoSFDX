<?xml version="1.0" encoding="utf-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
        <fullName>SPARTADMS__ManageCorporateDocument</fullName>
        <active>true</active>
        <description>Corporate document is locked.</description>
        <errorConditionFormula>IF(NOT( ISPICKVAL( SPARTADMS__Version_Status__c , 'Working') ), 
ISCHANGED( Name ) || 
ISCHANGED( SPARTADMS__Document_Type__c ) || 
ISCHANGED( SPARTADMS__Document_Department__c ) || 
ISCHANGED( SPARTADMS__Template_Type__c ) || 
ISCHANGED( SPARTADMS__Related_Quality_Event__c ) || 
ISCHANGED( SPARTADMS__Quality_Event_Reference__c) || 
ISCHANGED( SPARTADMS__Requires_Training__c) ||  
ISPICKVAL(SPARTADMS__Version_Status__c, 'Effective') &amp;&amp; ISCHANGED(SPARTADMS__Document_Auto_Effective_Days__c) || 
ISPICKVAL(SPARTADMS__Version_Status__c, 'Approved') &amp;&amp; ISPICKVAL(SPARTADMS__Document_Status__c,'OBSOLETE') &amp;&amp; ISCHANGED(SPARTADMS__Document_Auto_Effective_Days__c) || 
ISPICKVAL(SPARTADMS__Submission_Type__c, 'Obsolete Submission') &amp;&amp; ISPICKVAL(SPARTADMS__Document_Status__c,'EFFECTIVE') &amp;&amp; ISCHANGED(SPARTADMS__Document_Auto_Effective_Days__c), 

IF(ISPICKVAL( SPARTADMS__Version_Status__c , 'Working'), ISCHANGED( SPARTADMS__Document_Type__c ) || 
ISCHANGED( SPARTADMS__Document_Department__c ) || 
ISCHANGED( SPARTADMS__Template_Type__c ), false) 
)</errorConditionFormula>
        <errorMessage>Corporate document is locked.</errorMessage>
    </ValidationRule>
